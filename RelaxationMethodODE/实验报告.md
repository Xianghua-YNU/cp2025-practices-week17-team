# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** 邵星宇 **学号：** [20231050032] **完成日期：** [2025.6.18]

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
```

## 3. 实验结果

### 3.1 主要输出

- 最大高度：121.59 m
- 到达最大高度时间：5.00 s
- 迭代收敛次数：5432 次

### 3.2 结果验证

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状
![Figure_1](https://github.com/user-attachments/assets/a1d47ce9-30f3-456a-a496-b7f58b891771)

## 4. 问题与收获

### 4.1 主要问题

1. 收敛条件的设置
tol = 1e-6  # 收敛容差，默认1e-6

max_iter = 10000  # 最大迭代次数，默认10000

当所有网格点的变化量都小于tol时停止迭代

3. 迭代公式的正确实现
x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
即将二阶微分方程离散化求解，然后得到雅可比迭代公式。后续迭代过程中还加入了收敛条件的验证，边界条件验证。

### 4.2 解决方法

1. 使用最大变化量作为收敛判据
2. 仔细处理数组索引，确保边界条件

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。比如雅可比迭代法极其收敛条件判断。

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？

边值问题是空间上的边界条件，初值问题是时间上的边界条件。松弛法可以通过空间上的迭代实现全局的耦合性，两边约束的条件下可以求解。而初始条件是单边的。

3. 如何选择合适的收敛容差和最大迭代次数？

收敛容差：由精度需求、问题尺度和离散误差决定，通常 1e-6 是安全起点。
最大迭代次数：预估收敛速度后留出安全边际，稀疏问题可减少迭代。
容差应比目标精度严1~2个数量级，最大迭代次数应覆盖最坏情况。
通过合理设置这两个参数，可在精度和效率之间取得最优平衡。实际应用中建议通过网格独立性测试和残差历史分析进一步优化。
