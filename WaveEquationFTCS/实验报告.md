# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [邵星宇] **学号：** [20231050032] **完成日期：** [2025.6.18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
# 例如：FTCS更新公式的实现
# for j in range(1, t.size - 1):
#     u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]
```

## 3. 实验结果

### 3.1 主要输出

[请在此处插入关键数值结果或生成的动画截图/描述。例如，不同时间点的弦形图，或动画的简要描述。]
![image](https://github.com/user-attachments/assets/ef9956da-b3ab-4ee0-bd12-be1a21bf31c4)
![image](https://github.com/user-attachments/assets/c204e7f3-e292-42ef-ab1a-f26b7f13cbb3)

可以看到弦上的波并不是正弦函数，并且在两个固定端之间来回反弹。


### 3.2 结果验证

[要验证该波动方程解的准确性，需检查：1) **边界条件**是否始终保持 `u(0,t)=u(L,t)=0`；2) **波形传播**是否符合预期速度（波速 `a=100 m/s`）且无畸变；3) **数值稳定性**，确保CFL条件 `c=a*dt/dx<1` 满足；4) **能量守恒**，总能量波动应小于5%。若发现问题，优先调整时间步长 `dt` 或改用更稳定的算法（如蛙跳法）。动画可视化可直观验证波形行为。]

## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
  在处理初始速度条件时，首先需要确保初始速度函数 u_t(x) 满足物理边界条件（如两端速度为零），并通过数值离散将其正确转化为初始位移增量 u(x,1) = u_t(x)*dt；对于该代码示例，初始速度采用高斯调制抛物线分布，调整这些参数可改变初始激励特性，同时要保证时间步长 dt 足够小以避免离散误差，并验证初始能量分布是否符合物理预期。
*   如何确保数值稳定性？要确保数值稳定性，需满足CFL条件（c = a*dt/dx < 1），控制时间步长dt与空间步长dx的比例；优先选择显式方法（如蛙跳法）或隐式方法（如Crank-Nicolson）以增强稳定性；检查解的高频振荡和能量异常增长，必要时引入人工粘性（如κ∇²u项）抑制数值发散；通过网格收敛性测试验证步长合理性，确保误差随网格细化单调下降。
*   动画制作中的挑战？制作波动方程动画时，需平衡计算精度与实时性，确保时间步长满足CFL条件避免数值发散，同时优化绘图效率（如使用`FuncAnimation`的`blit`加速），并处理边界反射等物理真实性。]

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。初始速度的离散化需通过中心差分近似时间导数，，结合初始位移条件，从而将速度转化为首步位移增量，同时需保证足够小以维持精度。
*   调整时间步长以满足CFL条件。为确保数值稳定性，时间步长必须满足 CFL 条件若 dt过大，会导致解振荡或发散；可通过动态调整 平衡精度与效率。
*   学习Matplotlib动画模块的使用。先前有基础。]

### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
*   加深了对波动方程和有限差分法的理解。 通过实践掌握了波动方程的FTCS离散方法，理解了CFL条件对稳定性的关键作用，并学会通过调整步长和边界条件优化数值解，提升了对有限差分法精度与稳定性的调控能力。
*   掌握了Python进行科学计算和可视化的技能。通过编写波动方程求解程序，熟练运用NumPy实现高效数值计算，并借助Matplotlib的动画功能直观展示波形演化，掌握了Python科学计算与动态可视化的核心技能，提升了研究问题的表达能力。
*   认识到数值模拟中稳定性条件的重要性。数值模拟中，稳定性条件（如CFL）是算法可靠性的核心——步长选择不当会导致解振荡或发散，深刻理解了“精度易调，稳定难求”的数值计算本质。]

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？

波形会发生变化。

2. 尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
通过调整 \(\Delta t\) 和 \(\Delta x\) 发现：当 \(c = a\frac{\Delta t}{\Delta x} < 1\) 时，解稳定且波形传播准确；若 \(c \geq 1\)，数值解会因误差传播过快而剧烈振荡或发散，呈现非物理的锯齿状畸变。CFL条件是显式方法的稳定性底线，必须满足 \(c < 1\)，但过小的 \(c\) 虽稳定却降低计算效率，需平衡步长选择。
